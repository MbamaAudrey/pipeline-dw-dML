2026-02-04 22:39:01,215 - __main__ - INFO - ================================================================================
2026-02-04 22:39:01,216 - __main__ - INFO - üöÄ D√âMARRAGE DU PIPELINE ETL
2026-02-04 22:39:01,216 - __main__ - INFO - ================================================================================
2026-02-04 22:39:01,216 - __main__ - INFO - üì• [EXTRACT] D√©but de l'extraction des donn√©es source...
2026-02-04 22:39:01,216 - ETL.extract.extract_source - INFO - Connexion √† la base source: localhost:5433/source_db
2026-02-04 22:39:53,332 - ETL.extract.extract_source - INFO - ‚úÖ Extraction r√©ussie: 6,365,077 lignes, 13 colonnes
2026-02-04 22:39:53,335 - __main__ - INFO - ‚úÖ [EXTRACT] 6,365,077 transactions extraites avec succ√®s
2026-02-04 22:39:53,335 - __main__ - INFO - üîÑ [TRANSFORM] D√©but de la transformation des donn√©es...
2026-02-04 22:39:53,335 - __main__ - INFO -   ‚Üí Nettoyage des donn√©es...
2026-02-04 22:40:14,174 - ETL.transform.clean - INFO -   ‚Üí Doublons supprim√©s: 0 lignes
2026-02-04 22:40:15,939 - ETL.transform.clean - INFO -   ‚Üí Valeurs nulles remplac√©es: 0 valeurs
2026-02-04 22:40:18,480 - ETL.transform.clean - INFO -   ‚Üí R√©duction: 0 lignes supprim√©es (0.00%)
2026-02-04 22:40:18,480 - __main__ - INFO -   ‚úÖ Nettoyage termin√©: 6,365,077 ‚Üí 6,365,077 lignes (doublons supprim√©s)
2026-02-04 22:40:18,480 - __main__ - INFO -   ‚Üí Standardisation des colonnes...
2026-02-04 22:40:18,480 - ETL.transform.standardize - INFO -   ‚Üí Colonnes renomm√©es: 0 colonnes
2026-02-04 22:40:18,480 - __main__ - INFO -   ‚úÖ Standardisation termin√©e: 13 colonnes
2026-02-04 22:40:18,481 - __main__ - INFO -   ‚Üí Validation des donn√©es...
2026-02-04 22:40:18,486 - ETL.transform.validate - INFO -   ‚Üí Validation montants: 6,365,077 montants valides (>= 0)
2026-02-04 22:40:18,630 - ETL.transform.validate - INFO -   ‚Üí Validation origin_account: 6,365,077 comptes valides
2026-02-04 22:40:18,775 - ETL.transform.validate - INFO -   ‚Üí Validation destination_account: 6,365,077 comptes valides
2026-02-04 22:40:18,775 - __main__ - INFO -   ‚úÖ Validation r√©ussie: toutes les donn√©es sont valides
2026-02-04 22:40:18,775 - __main__ - INFO - ‚úÖ [TRANSFORM] Transformation termin√©e: 6,365,077 lignes pr√™tes pour le chargement
2026-02-04 22:40:18,775 - __main__ - INFO - üì§ [LOAD] D√©but du chargement dans le Data Warehouse...
2026-02-04 22:40:18,775 - __main__ - INFO -   ‚Üí Chargement de dim_transaction_type...
2026-02-04 22:40:18,775 - ETL.load.load_dim_transaction_type - INFO - Connexion au DW: localhost:5434/dw_db
2026-02-04 22:40:18,779 - ETL.load.load_dim_transaction_type - ERROR - ‚ùå Erreur lors du chargement de dim_transaction_type: connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2026-02-04 22:40:18,779 - __main__ - ERROR - ================================================================================
2026-02-04 22:40:18,779 - __main__ - ERROR - ‚ùå ERREUR CRITIQUE DANS LE PIPELINE ETL
2026-02-04 22:40:18,779 - __main__ - ERROR - Type d'erreur: OperationalError
2026-02-04 22:40:18,779 - __main__ - ERROR - Message: connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.
Traceback (most recent call last):
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/main_etl.py", line 71, in main
    load_dim_transaction_type(df)
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/load/load_dim_transaction_type.py", line 13, in load_dim_transaction_type
    conn = get_connection(DW_DB)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/db.py", line 4, in get_connection
    return psycopg2.connect(**cfg)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/venv/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2026-02-04 22:40:18,781 - __main__ - ERROR - ================================================================================
