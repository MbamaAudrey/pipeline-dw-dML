2026-02-05 00:04:41,737 - __main__ - INFO - ================================================================================
2026-02-05 00:04:41,737 - __main__ - INFO - üöÄ D√âMARRAGE DU PIPELINE ETL
2026-02-05 00:04:41,737 - __main__ - INFO - ================================================================================
2026-02-05 00:04:41,737 - __main__ - INFO - üì• [EXTRACT] D√©but de l'extraction des donn√©es source...
2026-02-05 00:04:41,737 - ETL.extract.extract_source - INFO - Connexion √† la base source: localhost:5433/source_db
2026-02-05 00:05:35,369 - ETL.extract.extract_source - INFO - ‚úÖ Extraction r√©ussie: 6,365,077 lignes, 13 colonnes
2026-02-05 00:05:35,372 - __main__ - INFO - ‚úÖ [EXTRACT] 6,365,077 transactions extraites avec succ√®s
2026-02-05 00:05:35,372 - __main__ - INFO - üîÑ [TRANSFORM] D√©but de la transformation des donn√©es...
2026-02-05 00:05:35,372 - __main__ - INFO -   ‚Üí Nettoyage des donn√©es...
2026-02-05 00:05:54,884 - ETL.transform.clean - INFO -   ‚Üí Doublons supprim√©s: 0 lignes
2026-02-05 00:05:56,232 - ETL.transform.clean - INFO -   ‚Üí Valeurs nulles remplac√©es: 0 valeurs
2026-02-05 00:05:58,754 - ETL.transform.clean - INFO -   ‚Üí R√©duction: 0 lignes supprim√©es (0.00%)
2026-02-05 00:05:58,754 - __main__ - INFO -   ‚úÖ Nettoyage termin√©: 6,365,077 ‚Üí 6,365,077 lignes (doublons supprim√©s)
2026-02-05 00:05:58,754 - __main__ - INFO -   ‚Üí Standardisation des colonnes...
2026-02-05 00:05:58,755 - ETL.transform.standardize - INFO -   ‚Üí Colonnes renomm√©es: 0 colonnes
2026-02-05 00:05:58,755 - __main__ - INFO -   ‚úÖ Standardisation termin√©e: 13 colonnes
2026-02-05 00:05:58,755 - __main__ - INFO -   ‚Üí Validation des donn√©es...
2026-02-05 00:05:58,759 - ETL.transform.validate - INFO -   ‚Üí Validation montants: 6,365,077 montants valides (>= 0)
2026-02-05 00:05:58,906 - ETL.transform.validate - INFO -   ‚Üí Validation origin_account: 6,365,077 comptes valides
2026-02-05 00:05:59,053 - ETL.transform.validate - INFO -   ‚Üí Validation destination_account: 6,365,077 comptes valides
2026-02-05 00:05:59,053 - __main__ - INFO -   ‚úÖ Validation r√©ussie: toutes les donn√©es sont valides
2026-02-05 00:05:59,053 - __main__ - INFO - ‚úÖ [TRANSFORM] Transformation termin√©e: 6,365,077 lignes pr√™tes pour le chargement
2026-02-05 00:05:59,053 - __main__ - INFO - üì§ [LOAD] D√©but du chargement dans le Data Warehouse...
2026-02-05 00:05:59,053 - __main__ - INFO -   ‚Üí Chargement de dim_transaction_type...
2026-02-05 00:05:59,053 - ETL.load.load_dim_transaction_type - INFO - Connexion au DW: localhost:5434/dw_db
2026-02-05 00:05:59,977 - ETL.load.load_dim_transaction_type - INFO -   ‚Üí 5 types de transactions uniques √† charger: ['DEBIT', 'PAYMENT', 'CASH_IN', 'CASH_OUT', 'TRANSFER']
2026-02-05 00:05:59,995 - ETL.load.load_dim_transaction_type - INFO -   ‚úÖ 5 types de transactions charg√©s dans dim_transaction_type
2026-02-05 00:05:59,996 - __main__ - INFO -   ‚úÖ dim_transaction_type charg√©
2026-02-05 00:05:59,996 - __main__ - INFO -   ‚Üí Chargement de dim_account...
2026-02-05 00:05:59,996 - ETL.load.load_dim_account - INFO - ‚Üí Chargement de dim_account...
2026-02-05 00:06:04,909 - ETL.load.load_dim_account - INFO -   ‚Üí 6,353,307 comptes d'origine, 2,722,362 comptes de destination
2026-02-05 00:06:04,910 - ETL.load.load_dim_account - INFO -   ‚Üí 10 comptes uniques √† charger (test limit√©)
2026-02-05 00:06:04,988 - ETL.load.load_dim_account - INFO - üéâ Tous les comptes test (10) ont √©t√© charg√©s avec succ√®s
2026-02-05 00:06:05,128 - __main__ - INFO -   ‚úÖ dim_account charg√©
2026-02-05 00:06:05,129 - __main__ - INFO -   ‚Üí Chargement de dim_time...
2026-02-05 00:06:05,158 - ETL.load.load_dim_time - INFO -   ‚Üí 743 pas de temps uniques √† charger (min: 1, max: 743)
2026-02-05 00:06:05,312 - ETL.load.load_dim_time - INFO -   ‚úÖ Batch 1: 743 pas de temps charg√©s
2026-02-05 00:06:05,313 - ETL.load.load_dim_time - INFO -   üéâ Tous les pas de temps ont √©t√© charg√©s avec succ√®s
2026-02-05 00:06:05,313 - __main__ - INFO -   ‚úÖ dim_time charg√©
2026-02-05 00:06:05,313 - __main__ - INFO -   ‚Üí Chargement de fact_transactions...
2026-02-05 00:06:05,319 - ETL.load.load_fact_transactions - INFO -   ‚Üí Chargement des mappings de dimensions...
2026-02-05 00:06:08,062 - ETL.load.load_fact_transactions - INFO -   ‚úÖ Mappings charg√©s: 10 comptes, 5 types, 743 pas de temps
2026-02-05 00:06:08,062 - ETL.load.load_fact_transactions - INFO -   ‚Üí D√©but du chargement de 6,365,077 transactions (batch size: 10,000)
2026-02-05 00:06:08,068 - ETL.load.load_fact_transactions - ERROR - ‚ùå Erreur lors du chargement de fact_transactions: 'C1171661049'
2026-02-05 00:06:08,069 - __main__ - ERROR - ================================================================================
2026-02-05 00:06:08,069 - __main__ - ERROR - ‚ùå ERREUR CRITIQUE DANS LE PIPELINE ETL
2026-02-05 00:06:08,069 - __main__ - ERROR - Type d'erreur: KeyError
2026-02-05 00:06:08,069 - __main__ - ERROR - Message: 'C1171661049'
Traceback (most recent call last):
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/main_etl.py", line 83, in main
    load_fact_transactions(df)
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/load/load_fact_transactions.py", line 40, in load_fact_transactions
    account_map[r.origin_account],
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyError: 'C1171661049'
2026-02-05 00:06:08,070 - __main__ - ERROR - ================================================================================
