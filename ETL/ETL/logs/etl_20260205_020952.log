2026-02-05 02:09:52,759 - __main__ - INFO - ================================================================================
2026-02-05 02:09:52,759 - __main__ - INFO - üöÄ D√âMARRAGE DU PIPELINE ETL
2026-02-05 02:09:52,759 - __main__ - INFO - ================================================================================
2026-02-05 02:09:52,759 - __main__ - INFO - üì• [EXTRACT] D√©but de l'extraction des donn√©es source...
2026-02-05 02:09:52,759 - ETL.extract.extract_source - INFO - Connexion √† la base source: localhost:5433/source_db
2026-02-05 02:09:52,821 - ETL.extract.extract_source - INFO - ‚úÖ Extraction r√©ussie: 0 lignes, 13 colonnes
2026-02-05 02:09:52,821 - __main__ - INFO - ‚úÖ [EXTRACT] 0 transactions extraites avec succ√®s
2026-02-05 02:09:52,822 - __main__ - INFO - üîÑ [TRANSFORM] D√©but de la transformation des donn√©es...
2026-02-05 02:09:52,822 - __main__ - INFO -   ‚Üí Nettoyage des donn√©es...
2026-02-05 02:09:52,823 - ETL.transform.clean - INFO -   ‚Üí Doublons supprim√©s: 0 lignes
2026-02-05 02:09:52,823 - ETL.transform.clean - INFO -   ‚Üí Valeurs nulles remplac√©es: 0 valeurs
2026-02-05 02:09:52,823 - ETL.transform.clean - INFO -   ‚Üí R√©duction: 0 lignes supprim√©es (0.00%)
2026-02-05 02:09:52,824 - __main__ - INFO -   ‚úÖ Nettoyage termin√©: 0 ‚Üí 0 lignes (doublons supprim√©s)
2026-02-05 02:09:52,824 - __main__ - INFO -   ‚Üí Standardisation des colonnes...
2026-02-05 02:09:52,825 - ETL.transform.standardize - INFO -   ‚Üí Colonnes renomm√©es: 0 colonnes
2026-02-05 02:09:52,825 - __main__ - INFO -   ‚úÖ Standardisation termin√©e: 13 colonnes
2026-02-05 02:09:52,825 - __main__ - INFO -   ‚Üí Validation des donn√©es...
2026-02-05 02:09:52,825 - ETL.transform.validate - INFO -   ‚Üí Validation montants: 0 montants valides (>= 0)
2026-02-05 02:09:52,825 - ETL.transform.validate - INFO -   ‚Üí Validation origin_account: 0 comptes valides
2026-02-05 02:09:52,826 - ETL.transform.validate - INFO -   ‚Üí Validation destination_account: 0 comptes valides
2026-02-05 02:09:52,826 - __main__ - INFO -   ‚úÖ Validation r√©ussie: toutes les donn√©es sont valides
2026-02-05 02:09:52,826 - __main__ - INFO - ‚úÖ [TRANSFORM] Transformation termin√©e: 0 lignes pr√™tes pour le chargement
2026-02-05 02:09:52,826 - __main__ - INFO - üì§ [LOAD] D√©but du chargement dans le Data Warehouse...
2026-02-05 02:09:52,826 - __main__ - INFO -   ‚Üí Chargement de dim_transaction_type...
2026-02-05 02:09:52,826 - ETL.load.load_dim_transaction_type - INFO - Connexion au DW: localhost:5434/dw_db
2026-02-05 02:09:52,833 - ETL.load.load_dim_transaction_type - INFO -   ‚Üí 0 types de transactions uniques √† charger: []
2026-02-05 02:09:52,833 - ETL.load.load_dim_transaction_type - INFO -   ‚úÖ 0 types de transactions charg√©s dans dim_transaction_type
2026-02-05 02:09:52,833 - __main__ - INFO -   ‚úÖ dim_transaction_type charg√©
2026-02-05 02:09:52,833 - __main__ - INFO -   ‚Üí Chargement de dim_account...
2026-02-05 02:09:52,833 - ETL.load.load_dim_account - INFO - ‚Üí Chargement de dim_account (mode flux : pas de liste compl√®te en m√©moire)...
2026-02-05 02:09:52,839 - ETL.load.load_dim_account - INFO -   ‚Üí 0 lignes ‚Üí 0 chunks de 50,000 lignes
2026-02-05 02:09:52,855 - ETL.load.load_dim_account - INFO - üéâ Chargement dim_account termin√© (traitement par flux, pas de saturation m√©moire)
2026-02-05 02:09:52,855 - __main__ - INFO -   ‚úÖ dim_account charg√©
2026-02-05 02:09:52,855 - __main__ - INFO -   ‚Üí Chargement de dim_time...
2026-02-05 02:09:52,863 - ETL.load.load_dim_time - WARNING -   ‚Üí Aucun pas de temps √† charger (colonne step vide).
2026-02-05 02:09:52,863 - __main__ - INFO -   ‚úÖ dim_time charg√©
2026-02-05 02:09:52,863 - __main__ - INFO -   ‚Üí Chargement de fact_transactions...
2026-02-05 02:09:52,869 - ETL.load.load_fact_transactions - INFO -   ‚Üí Chargement des mappings de dimensions...
2026-02-05 02:09:53,113 - ETL.load.load_fact_transactions - INFO -   ‚úÖ Mappings charg√©s: 10 comptes, 5 types, 743 pas de temps
2026-02-05 02:09:53,113 - ETL.load.load_fact_transactions - INFO -   ‚Üí D√©but du chargement de 0 transactions (batch size: 10,000)
2026-02-05 02:09:53,113 - ETL.load.load_fact_transactions - INFO -   ‚úÖ 0 transactions charg√©es dans fact_transactions (0 batches)
2026-02-05 02:09:53,113 - __main__ - INFO -   ‚úÖ fact_transactions charg√©
2026-02-05 02:09:53,114 - __main__ - INFO - ‚úÖ [LOAD] Chargement termin√© avec succ√®s
2026-02-05 02:09:53,114 - __main__ - INFO - üìä [DATA MART] Construction du data mart ML...
2026-02-05 02:09:53,120 - ETL.data_mart.build_ml_mart - INFO -   ‚Üí Suppression de l'ancienne table transactions_ml_mart si elle existe...
2026-02-05 02:09:53,121 - ETL.data_mart.build_ml_mart - INFO -   ‚Üí Cr√©ation de la table transactions_ml_mart...
2026-02-05 02:09:53,144 - ETL.data_mart.build_ml_mart - INFO -   ‚úÖ Table transactions_ml_mart cr√©√©e: 0 lignes
2026-02-05 02:09:53,144 - ETL.data_mart.build_ml_mart - ERROR - ‚ùå Erreur lors de la construction du data mart ML: division by zero
2026-02-05 02:09:53,144 - __main__ - ERROR - ================================================================================
2026-02-05 02:09:53,144 - __main__ - ERROR - ‚ùå ERREUR CRITIQUE DANS LE PIPELINE ETL
2026-02-05 02:09:53,144 - __main__ - ERROR - Type d'erreur: ZeroDivisionError
2026-02-05 02:09:53,144 - __main__ - ERROR - Message: division by zero
Traceback (most recent call last):
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/main_etl.py", line 90, in main
    build_ml_mart()
  File "/Users/christaudreymbama/Documents/fraud-detection-platform/ETL/data_mart/build_ml_mart.py", line 43, in build_ml_mart
    logger.info(f"  ‚Üí Statistiques: {fraud_count:,} fraudes ({fraud_count/row_count*100:.2f}%), {row_count-fraud_count:,} transactions normales")
                                                              ~~~~~~~~~~~^~~~~~~~~~
ZeroDivisionError: division by zero
2026-02-05 02:09:53,145 - __main__ - ERROR - ================================================================================
